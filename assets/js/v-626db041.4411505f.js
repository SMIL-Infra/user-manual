"use strict";(self.webpackChunksmil_infra_user_manual=self.webpackChunksmil_infra_user_manual||[]).push([[232],{8211:(t,e,n)=>{n.r(e),n.d(e,{default:()=>_});var a=n(6252),c=n(9963),o=n(3577);const r={key:0},u={key:1},i={key:2},l={key:3},s={key:0},m={key:1},p=Math.round(Date.now()/864e5),h={props:{account:{type:Object,required:!0}},methods:{timeText:t=>t>=0?`${t}天后`:`已过期（${-t}天前）`},computed:{host(){return this.account.metric.instance.replace(/:\d+$/,"")},passwordExpire(){const t=parseInt(this.account.metric.pw_maxage);if(t>9e4)return null;const e=parseInt(this.account.metric.pw_lastchange)+t-p;return this.timeText(e)},accountExpire(){const t=parseInt(this.account.metric.expire);return-1===t?null:this.timeText(t-p)}}};var d=n(3744);const w={components:{LocalAccountHost:(0,d.Z)(h,[["render",function(t,e,n,c,r,u){return(0,a.wg)(),(0,a.iD)("li",null,[(0,a.Uk)((0,o.zw)(u.host)+" ",1),(0,a._)("ul",null,[u.passwordExpire?((0,a.wg)(),(0,a.iD)("li",s,"密码过期："+(0,o.zw)(u.passwordExpire),1)):(0,a.kq)("",!0),u.accountExpire?((0,a.wg)(),(0,a.iD)("li",m,"账户过期："+(0,o.zw)(u.accountExpire),1)):(0,a.kq)("",!0)])])}]])},data:()=>({name:"",loading:!1,error:null,accountInfo:null}),methods:{async queryAccount(){this.loading=!0;const t=new URL("https://prometheus.scut-smil.cn/api/v1/query");t.searchParams.set("query",`node_local_account_info{name="${this.name}"}`);try{const e=await fetch(t),n=await e.json();this.accountInfo=n.data.result}catch(t){this.error=t}finally{this.loading=!1}}}},f=(0,d.Z)(w,[["render",function(t,e,n,s,m,p){const h=(0,a.up)("LocalAccountHost");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("form",null,[(0,a.wy)((0,a._)("input",{type:"text",name:"name",id:"name",placeholder:"用户名","onUpdate:modelValue":e[0]||(e[0]=t=>m.name=t)},null,512),[[c.nr,m.name]]),(0,a._)("button",{type:"submit",onClick:e[1]||(e[1]=(0,c.iM)(((...t)=>p.queryAccount&&p.queryAccount(...t)),["prevent"]))},"查询")]),m.loading?((0,a.wg)(),(0,a.iD)("p",r,"加载中")):(0,a.kq)("",!0),null!==m.error?((0,a.wg)(),(0,a.iD)("p",u,(0,o.zw)(m.error),1)):null!==m.accountInfo&&0===m.accountInfo.length?((0,a.wg)(),(0,a.iD)("p",i," 没有查询到本地账号。 ")):(0,a.kq)("",!0),null!==m.accountInfo?((0,a.wg)(),(0,a.iD)("ul",l,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(m.accountInfo,(t=>((0,a.wg)(),(0,a.j4)(h,{key:t.metric.instance,account:t},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(t.metric.instance),1)])),_:2},1032,["account"])))),128))])):(0,a.kq)("",!0)])}]]),k=(0,a._)("h1",{id:"本地账户查询",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#本地账户查询","aria-hidden":"true"},"#"),(0,a.Uk)(" 本地账户查询")],-1),y=(0,a._)("p",null,"本页可查询你所有尚未迁移到FreeIPA的本地账号，及其相关情况。数据每分钟更新。",-1),g=(0,a._)("p",null,"该功能仅能在校园网内使用。",-1),_={setup:t=>(t,e)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[k,y,g,(0,a.Wm)(f)],64))}},8670:(t,e,n)=>{n.r(e),n.d(e,{data:()=>a});const a={key:"v-626db041",path:"/auth/my-local-account.html",title:"本地账户查询",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[],filePathRelative:"auth/my-local-account.md",git:{updatedTime:1637038962e3,contributors:[{name:"胡玮文",email:"huww98@163.com",commits:1},{name:"胡玮文",email:"huww98@outlook.com",commits:1}]}}}}]);